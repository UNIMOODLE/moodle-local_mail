import{S as D,b as j,e as E,f as H,g as y,n as S,h as v,G as R,H as F,P as I,j as _,r as U,t as q,k as d,m as g,o as C,T as G,ak as p,a5 as M,U as z,aj as A,$ as J}from"./global-QlwbzmWg.js";function L(i,t,e){const s=i.slice();return s[8]=t[e],s}function N(i){let t,e,s,n,f=i[0].sendmail+"",c,o,a,r,b=[],u=new Map,h=I(["to","cc","bcc"]);const k=l=>l[8];for(let l=0;l<3;l+=1){let m=L(i,h,l),w=k(m);u.set(w,b[l]=P(w,m))}return{c(){t=_("div"),e=_("button"),s=_("i"),n=U(),c=q(f),a=U(),r=_("div");for(let l=0;l<3;l+=1)b[l].c();d(s,"class","fa fa-envelope-o mr-1"),d(s,"aria-hidden","true"),d(e,"type","button"),d(e,"class","btn btn-outline-secondary text-dark bg-white dropdown-toggle"),d(e,"data-toggle","dropdown"),d(e,"aria-expanded","false"),e.disabled=o=!i[2].length,d(r,"class","dropdown-menu"),d(t,"class","btn-group ml-3")},m(l,m){y(l,t,m),g(t,e),g(e,s),g(e,n),g(e,c),g(t,a),g(t,r);for(let w=0;w<3;w+=1)b[w]&&b[w].m(r,null)},p(l,m){m&1&&f!==(f=l[0].sendmail+"")&&C(c,f),m&4&&o!==(o=!l[2].length)&&(e.disabled=o),m&7&&(h=I(["to","cc","bcc"]),b=G(b,m,k,1,l,h,u,r,z,P,null,L))},d(l){l&&v(t);for(let m=0;m<3;m+=1)b[m].d()}}}function P(i,t){let e,s=t[0][t[8]]+"",n,f,c;return{key:i,first:null,c(){e=_("a"),n=q(s),f=U(),d(e,"class","dropdown-item"),d(e,"href",c=p(t[1].id,t[2],t[8])),this.first=e},m(o,a){y(o,e,a),g(e,n),g(e,f)},p(o,a){t=o,a&1&&s!==(s=t[0][t[8]]+"")&&C(n,s),a&6&&c!==(c=p(t[1].id,t[2],t[8]))&&d(e,"href",c)},d(o){o&&v(e)}}}function K(i){let t,e=i[1]&&N(i);return{c(){e&&e.c(),t=H()},m(s,n){e&&e.m(s,n),y(s,t,n)},p(s,[n]){s[1]?e?e.p(s,n):(e=N(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:S,o:S,d(s){s&&v(t),e&&e.d(s)}}}function O(i,t,e){let s,{strings:n}=t,{courses:f}=t,{userid:c}=t,{courseid:o}=t,{form:a}=t,r=[];R(async()=>{(await M("core/pubsub")).subscribe("core/checkbox-toggleall:checkboxToggled",b),b()}),F(async()=>{(await M("core/pubsub")).unsubscribe("core/checkbox-toggleall:checkboxToggled",b)});const b=async()=>{e(2,r=[]);const u=new FormData(a);for(const h of u.keys()){const k=/^user(\d+)$/.exec(h);if(k){const l=parseInt(k[1]);l!=c&&r.push(l)}}};return i.$$set=u=>{"strings"in u&&e(0,n=u.strings),"courses"in u&&e(3,f=u.courses),"userid"in u&&e(4,c=u.userid),"courseid"in u&&e(5,o=u.courseid),"form"in u&&e(6,a=u.form)},i.$$.update=()=>{i.$$.dirty&40&&e(1,s=f.find(u=>u.id==o))},[n,s,r,f,c,o,a]}class Q extends D{constructor(t){super(),j(this,t,O,K,E,{strings:0,courses:3,userid:4,courseid:5,form:6})}}function T(i){let t,e,s,n=i[1].sendmail+"",f,c;return{c(){t=_("a"),e=_("i"),s=U(),f=q(n),d(e,"class","fa fa-envelope-o mr-1"),d(e,"aria-hidden","true"),d(t,"class","btn"),d(t,"href",c=p(i[3],[i[2]],"to"))},m(o,a){y(o,t,a),g(t,e),g(t,s),g(t,f)},p(o,a){a&2&&n!==(n=o[1].sendmail+"")&&C(f,n),a&12&&c!==(c=p(o[3],[o[2]],"to"))&&d(t,"href",c)},d(o){o&&v(t)}}}function V(i){let t,e=i[2]!=i[0]&&i[4]&&T(i);return{c(){e&&e.c(),t=H()},m(s,n){e&&e.m(s,n),y(s,t,n)},p(s,[n]){s[2]!=s[0]&&s[4]?e?e.p(s,n):(e=T(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:S,o:S,d(s){s&&v(t),e&&e.d(s)}}}function W(i,t,e){let s,{userid:n}=t,{strings:f}=t,{courses:c}=t,{id:o}=t,{courseid:a}=t;return i.$$set=r=>{"userid"in r&&e(0,n=r.userid),"strings"in r&&e(1,f=r.strings),"courses"in r&&e(5,c=r.courses),"id"in r&&e(2,o=r.id),"courseid"in r&&e(3,a=r.courseid)},i.$$.update=()=>{i.$$.dirty&40&&e(4,s=c.find(r=>r.id==a))},[n,f,o,a,s,c]}class X extends D{constructor(t){super(),j(this,t,W,V,E,{userid:0,strings:1,courses:5,id:2,courseid:3})}}async function Y(){const i=window.local_mail_navbar_data;if(!i)return;Z(i);const t=window.location.origin+window.location.pathname,e=new URLSearchParams(window.location.search);t==window.M.cfg.wwwroot+"/user/view.php"?x(i,parseInt(e.get("id")||""),parseInt(e.get("course")||"")):t==window.M.cfg.wwwroot+"/user/index.php"?B(i,parseInt(e.get("id")||"")):t==window.M.cfg.wwwroot+"/blocks/completion_progress/overview.php"&&B(i,parseInt(e.get("courseid")||""))}function Z(i){const t=document.getElementById("local-mail-navbar");if(t){t.innerHTML="";const e=new A({target:t,props:{settings:i.settings,strings:i.strings,courses:i.courses,labels:i.labels,params:{courseid:i.courseid},onClick:s=>{window.location.href=J(s)},onComposeClick:s=>{window.location.href=p(s)},onCourseChange:s=>{e.$set({params:{courseid:s}})}}})}}function B(i,t){var n;const e=(n=document.querySelector("#formactionid"))==null?void 0:n.parentElement,s=document.querySelector("#participantsform");t&&e&&s&&new Q({target:e,props:{userid:i.userid,strings:i.strings,courses:i.courses,courseid:t,form:document.querySelector("#participantsform")}})}function x(i,t,e){const s=document.querySelector(".userprofile .header-button-group");t&&e&&s&&new X({target:s,props:{userid:i.userid,strings:i.strings,courses:i.courses,id:t,courseid:e}})}Y();
//# sourceMappingURL=navigation-uSOUNgyA.js.map
