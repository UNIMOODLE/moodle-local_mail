import{S as D,b as E,e as j,H as F,k as y,n as S,C as v,E as H,F as R,P as M,h as _,g as U,t as q,j as d,m as g,u as I,T as z,aj as p,a6 as C,U as A,ai as G,$ as J}from"./global-61298ce6.js";function L(s,t,e){const i=s.slice();return i[8]=t[e],i}function N(s){let t,e,i,n,f=s[0].sendmail+"",c,o,u,r,b=[],a=new Map,h=M(["to","cc","bcc"]);const k=l=>l[8];for(let l=0;l<3;l+=1){let m=L(s,h,l),w=k(m);a.set(w,b[l]=P(w,m))}return{c(){t=_("div"),e=_("button"),i=_("i"),n=U(),c=q(f),u=U(),r=_("div");for(let l=0;l<3;l+=1)b[l].c();d(i,"class","fa fa-envelope-o mr-1"),d(i,"aria-hidden","true"),d(e,"type","button"),d(e,"class","btn btn-outline-secondary text-dark bg-white dropdown-toggle"),d(e,"data-toggle","dropdown"),d(e,"aria-expanded","false"),e.disabled=o=!s[1].length,d(r,"class","dropdown-menu"),d(t,"class","btn-group ml-3")},m(l,m){y(l,t,m),g(t,e),g(e,i),g(e,n),g(e,c),g(t,u),g(t,r);for(let w=0;w<3;w+=1)b[w]&&b[w].m(r,null)},p(l,m){m&1&&f!==(f=l[0].sendmail+"")&&I(c,f),m&2&&o!==(o=!l[1].length)&&(e.disabled=o),m&7&&(h=M(["to","cc","bcc"]),b=z(b,m,k,1,l,h,a,r,A,P,null,L))},d(l){l&&v(t);for(let m=0;m<3;m+=1)b[m].d()}}}function P(s,t){let e,i=t[0][t[8]]+"",n,f,c;return{key:s,first:null,c(){e=_("a"),n=q(i),f=U(),d(e,"class","dropdown-item"),d(e,"href",c=p(t[2].id,t[1],t[8])),this.first=e},m(o,u){y(o,e,u),g(e,n),g(e,f)},p(o,u){t=o,u&1&&i!==(i=t[0][t[8]]+"")&&I(n,i),u&6&&c!==(c=p(t[2].id,t[1],t[8]))&&d(e,"href",c)},d(o){o&&v(e)}}}function K(s){let t,e=s[2]&&N(s);return{c(){e&&e.c(),t=F()},m(i,n){e&&e.m(i,n),y(i,t,n)},p(i,[n]){i[2]?e?e.p(i,n):(e=N(i),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:S,o:S,d(i){i&&v(t),e&&e.d(i)}}}function O(s,t,e){let i,{strings:n}=t,{courses:f}=t,{userid:c}=t,{courseid:o}=t,{form:u}=t,r=[];H(async()=>{(await C("core/pubsub")).subscribe("core/checkbox-toggleall:checkboxToggled",b),b()}),R(async()=>{(await C("core/pubsub")).unsubscribe("core/checkbox-toggleall:checkboxToggled",b)});const b=async()=>{e(1,r=[]);const a=new FormData(u);for(const h of a.keys()){const k=/^user(\d+)$/.exec(h);if(k){const l=parseInt(k[1]);l!=c&&r.push(l)}}};return s.$$set=a=>{"strings"in a&&e(0,n=a.strings),"courses"in a&&e(3,f=a.courses),"userid"in a&&e(4,c=a.userid),"courseid"in a&&e(5,o=a.courseid),"form"in a&&e(6,u=a.form)},s.$$.update=()=>{s.$$.dirty&40&&e(2,i=f.find(a=>a.id==o))},[n,r,i,f,c,o,u]}class Q extends D{constructor(t){super(),E(this,t,O,K,j,{strings:0,courses:3,userid:4,courseid:5,form:6})}}function T(s){let t,e,i,n=s[1].sendmail+"",f,c;return{c(){t=_("a"),e=_("i"),i=U(),f=q(n),d(e,"class","fa fa-envelope-o mr-1"),d(e,"aria-hidden","true"),d(t,"class","btn"),d(t,"href",c=p(s[3],[s[2]],"to"))},m(o,u){y(o,t,u),g(t,e),g(t,i),g(t,f)},p(o,u){u&2&&n!==(n=o[1].sendmail+"")&&I(f,n),u&12&&c!==(c=p(o[3],[o[2]],"to"))&&d(t,"href",c)},d(o){o&&v(t)}}}function V(s){let t,e=s[2]!=s[0]&&s[4]&&T(s);return{c(){e&&e.c(),t=F()},m(i,n){e&&e.m(i,n),y(i,t,n)},p(i,[n]){i[2]!=i[0]&&i[4]?e?e.p(i,n):(e=T(i),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:S,o:S,d(i){i&&v(t),e&&e.d(i)}}}function W(s,t,e){let i,{userid:n}=t,{strings:f}=t,{courses:c}=t,{id:o}=t,{courseid:u}=t;return s.$$set=r=>{"userid"in r&&e(0,n=r.userid),"strings"in r&&e(1,f=r.strings),"courses"in r&&e(5,c=r.courses),"id"in r&&e(2,o=r.id),"courseid"in r&&e(3,u=r.courseid)},s.$$.update=()=>{s.$$.dirty&40&&e(4,i=c.find(r=>r.id==u))},[n,f,o,u,i,c]}class X extends D{constructor(t){super(),E(this,t,W,V,j,{userid:0,strings:1,courses:5,id:2,courseid:3})}}async function Y(){const s=window.local_mail_navbar_data;if(!s)return;Z(s);const t=window.location.origin+window.location.pathname,e=new URLSearchParams(window.location.search);t==window.M.cfg.wwwroot+"/user/view.php"?x(s,parseInt(e.get("id")||""),parseInt(e.get("course")||"")):t==window.M.cfg.wwwroot+"/user/index.php"?B(s,parseInt(e.get("id")||"")):t==window.M.cfg.wwwroot+"/blocks/completion_progress/overview.php"&&B(s,parseInt(e.get("courseid")||""))}function Z(s){const t=document.getElementById("local-mail-navbar");t&&(t.innerHTML="",new G({target:t,props:{settings:s.settings,strings:s.strings,unread:s.unread,drafts:s.drafts,courses:s.courses,labels:s.labels,onClick:e=>{window.location.href=J(e)},onComposeClick:e=>{window.location.href=p(e)}}}))}function B(s,t){var n;const e=(n=document.querySelector("#formactionid"))==null?void 0:n.parentElement,i=document.querySelector("#participantsform");t&&e&&i&&new Q({target:e,props:{userid:s.userid,strings:s.strings,courses:s.courses,courseid:t,form:document.querySelector("#participantsform")}})}function x(s,t,e){const i=document.querySelector(".userprofile .header-button-group");t&&e&&i&&new X({target:i,props:{userid:s.userid,strings:s.strings,courses:s.courses,id:t,courseid:e}})}Y();
//# sourceMappingURL=navigation-85dd82b9.js.map
